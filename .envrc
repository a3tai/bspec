# BSpec Development Environment
# Uses 1Password CLI for secure secret management
# See .envrc.example for setup instructions

# =============================================================================
# 1Password Setup
# =============================================================================

if ! command -v op &> /dev/null; then
    echo "âš ï¸  1Password CLI (op) not found. Install with: brew install 1password-cli"
    return 1
fi

# Sign in once (single biometric prompt, cached for subsequent reads)
if ! op account get &>/dev/null; then
    echo "ðŸ” Authenticating with 1Password..."
    eval "$(op signin)"
fi

# =============================================================================
# AI API Keys (from A3T/Environment)
# =============================================================================

export GEMINI_API_KEY="$(op read 'op://A3T/Environment/GEMINI_API_KEY' 2>/dev/null || echo 'NOT_SET')"
export EXA_API_KEY="$(op read 'op://A3T/Environment/EXA_API_KEY' 2>/dev/null || echo 'NOT_SET')"
export FIRECRAWL_API_KEY="$(op read 'op://A3T/Environment/FIRECRAWL_API_KEY' 2>/dev/null || echo 'NOT_SET')"
export OPENROUTER_API_KEY="$(op read 'op://A3T/Environment/OPENROUTER_API_KEY' 2>/dev/null || echo 'NOT_SET')"
export ANTHROPIC_API_KEY="$(op read 'op://A3T/Environment/ANTHROPIC_API_KEY' 2>/dev/null || echo 'NOT_SET')"
export OPENAI_API_KEY="$(op read 'op://A3T/Environment/OPENAI_API_KEY' 2>/dev/null || echo 'NOT_SET')"

# =============================================================================
# Cloudflare - bspec.dev (Rude Company LLC account)
# =============================================================================

export CLOUDFLARE_ACCOUNT_ID="$(op read 'op://A3T/Environment/CLOUDFLARE_ACCOUNT_ID' 2>/dev/null || echo 'NOT_SET')"

# =============================================================================
# Project Paths
# =============================================================================

export BSPEC_ROOT="$(pwd)"
PATH_add "$BSPEC_ROOT/sdk/cli/bin"

# =============================================================================
# Status
# =============================================================================

echo "âœ“ BSpec environment loaded"
echo "  BSPEC_ROOT: $BSPEC_ROOT"
